fitMeasures(fit_1a, c("chisq", "df", "pvalue", "cfi", "tli", "rmsea"))
fitMeasures(fit_1b, c("chisq", "df", "pvalue", "cfi", "tli", "rmsea"))
fitMeasures(fit_1c, c("chisq", "df", "pvalue", "cfi", "tli", "rmsea"))
standardizedSolution(fit_1c)
mod=modificationindices(fit_1c)
subset(mod, mi>3.84, select=lhs:mi)
mod=modificationindices(fit_1b)
subset(mod, mi>3.84, select=lhs:mi)
subset(mod, mi>3.84, select=lhs:mi)
# queda fuera c05_08 porque mi alto
cfa_1d <- '
confianza =~ c05_01_w01 + c05_02_w01 + c05_05_w01+ c05_07_w01
'
fit_1d <- cfa(cfa_1d,data=conf_institucional,missing="ML",estimator="MLR")
fitMeasures(fit_1d, c("chisq", "df", "pvalue", "cfi", "tli", "rmsea"))
semPaths(fit_1d, title = FALSE, fixedStyle = c(1, 1),
curvePivot = FALSE,layout = "tree2", rotation=2, style="lisrel")
fitMeasures(fit_1a, c("chisq", "df", "pvalue", "cfi", "tli", "rmsea"))
fitMeasures(fit_1b, c("chisq", "df", "pvalue", "cfi", "tli", "rmsea"))
fitMeasures(fit_1c, c("chisq", "df", "pvalue", "cfi", "tli", "rmsea"))
fitMeasures(fit_1d, c("chisq", "df", "pvalue", "cfi", "tli", "rmsea"))
semPaths(fit_1d, title = FALSE, fixedStyle = c(1, 1),
curvePivot = FALSE,layout = "tree2", rotation=2, style="lisrel")
solidaridad = data %>%
dplyr::select(c07_01_w01, c07_02_w01, c07_03_w01, c07_04_w01, c07_05_w01, c07_06_w01, c07_07_w01, c07_08_w01) %>%
as.data.frame() %>%
na.omit()
corMat  <- cor(solidaridad, use="na.or.complete", method="spearman")  # estimar matriz correlacion
stargazer(corMat, title="correlaciones", type = "text") #Latex table
KMO(corMat)
cortest.bartlett(corMat, n = 1836)
cfa_1a <- '
solidaridad =~ c07_01_w01 + c07_02_w01 + c07_03_w01 + c07_04_w01 + c07_05_w01 + c07_06_w01 + c07_07_w01 + c07_08_w01
'
fit_1a <- cfa(cfa_1a,data=solidaridad,missing="ML",estimator="MLR")
fitMeasures(fit_1a, c("chisq", "df", "pvalue", "cfi", "tli", "rmsea"))
standardizedSolution(fit_1a)
standardizedSolution(fit_1a)
# Se deja fuera c07_01, c07_02, c07_03 y c07_04 porque est.std < 0.5
cfa_1b <- '
solidaridad =~ c07_05_w01 + c07_06_w01 + c07_07_w01 + c07_08_w01
'
fit_1b <- cfa(cfa_1b,data=conf_institucional,missing="ML",estimator="MLR")
fit_1b <- cfa(cfa_1b,data=solidaridad,missing="ML",estimator="MLR")
show(fit_1b) # Resumen ajuste general
fitMeasures(fit_1b, c("chisq", "df", "pvalue", "cfi", "tli", "rmsea"))
semPaths(fit_1b, title = FALSE, fixedStyle = c(1, 1),
curvePivot = FALSE,layout = "tree2", rotation=2, style="lisrel")
standardizedSolution(fit_1ab
standardizedSolution(fit_1b)
standardizedSolution(fit_1b)
semPaths(fit_1b, intercepts = FALSE,edge.label.cex=1.5, optimizeLatRes = TRUE, groups = "lat",pastel = TRUE, exoVar = FALSE, sizeInt=5,edge.color ="black",esize = 6, label.prop=2,sizeLat = 6,"std", layout="circle2")
# se dejan fuera c07_01, c07_02 y c07_04 por bajas correlaciones
cfa_1b <- '
solidaridad =~ c07_03_w01 + c07_05_w01 + c07_06_w01 + c07_07_w01 + c07_08_w01
'
fit_1b <- cfa(cfa_1b,data=solidaridad,missing="ML",estimator="MLR")
semPaths(fit_1b, intercepts = FALSE,edge.label.cex=1.5, optimizeLatRes = TRUE, groups = "lat",pastel = TRUE, exoVar = FALSE, sizeInt=5,edge.color ="black",esize = 6, label.prop=2,sizeLat = 6,"std", layout="circle2")
fitMeasures(fit_1b, c("chisq", "df", "pvalue", "cfi", "tli", "rmsea"))
fitMeasures(fit_1a, c("chisq", "df", "pvalue", "cfi", "tli", "rmsea"))
summary(fit_1d, fit.measures=T, standardized=T)
fitMeasures(fit_1d, c("chisq", "df", "pvalue", "cfi", "tli", "rmsea"))
cfa_1b <- '
lazos =~ r15_w02
confianza =~ c02_w01 + c03_w01 + c04_w01
prejuicios =~ r12_03_w01 + r12_04_w01
diversidad =~ c06_04_w01 + c06_05_w01 + c06_06_w01
'
fitMeasures(fit_1b, c("chisq", "df", "pvalue", "cfi", "tli", "rmsea"))
semPaths(fit_1b, intercepts = FALSE,edge.label.cex=1.5, optimizeLatRes = TRUE, groups = "lat",pastel = TRUE, exoVar = FALSE, sizeInt=5,edge.color ="black",esize = 6, label.prop=2,sizeLat = 6,"std", layout="circle2")
relaciones_sociales = data %>%
dplyr::select(r15_w02, c02_w01, c03_w01, c04_w01, r12_03_w01, r12_04_w01, c06_04_w01, c06_05_w01, c06_06_w01) %>%
as.data.frame() %>%
na.omit()
corMat  <- cor(relaciones_sociales, use="na.or.complete", method="spearman")  # estimar matriz correlacion
cfa_1a <- '
lazos =~ r15_w02
confianza =~ c02_w01 + c03_w01 + c04_w01
diversidad =~ r12_03_w01 + r12_04_w01 + c06_04_w01 + c06_05_w01 + c06_06_w01
'
fit_1a <- cfa(cfa_1a,data=relaciones_sociales,missing="ML",estimator="MLR")
fitMeasures(fit_1a, c("chisq", "df", "pvalue", "cfi", "tli", "rmsea"))
semPaths(fit_1a, intercepts = FALSE,edge.label.cex=1.5, optimizeLatRes = TRUE, groups = "lat",pastel = TRUE, exoVar = FALSE, sizeInt=5,edge.color ="black",esize = 6, label.prop=2,sizeLat = 6,"std", layout="circle2")
cfa_1b <- '
lazos =~ r15_w02
confianza =~ c02_w01 + c03_w01 + c04_w01
prejuicios =~ r12_03_w01 + r12_04_w01
diversidad =~ c06_04_w01 + c06_05_w01 + c06_06_w01
'
fit_1b <- cfa(cfa_1b,data=relaciones_sociales,missing="ML",estimator="MLR")
fitMeasures(fit_1b, c("chisq", "df", "pvalue", "cfi", "tli", "rmsea"))
semPaths(fit_1b, intercepts = FALSE,edge.label.cex=1.5, optimizeLatRes = TRUE, groups = "lat",pastel = TRUE, exoVar = FALSE, sizeInt=5,edge.color ="black",esize = 6, label.prop=2,sizeLat = 6,"std", layout="circle2")
## Se elimina preguntas sobre confianza hacia homosexuales, mapuche e inmigrantes
cfa_1c <- '
lazos =~ r15_w02
diversidad =~ c06_04_w01 + c06_05_w01 + c06_06_w01
prejuicios =~ r12_03_w01 + r12_04_w01
'
fit_1c <- cfa(cfa_1c,data=relaciones_sociales,missing="ML",estimator="MLR")
fitMeasures(fit_1c, c("chisq", "df", "pvalue", "cfi", "tli", "rmsea"))
fitMeasures(fit_1b, c("chisq", "df", "pvalue", "cfi", "tli", "rmsea"))
pertenencia = data %>%
dplyr::select(c32_01_w01, c32_02_w01, c18_09_w01, c18_10_w01, c05_01_w01, c05_02_w01, c05_05_w01, c05_07_w01, c05_08_w01) %>%
as.data.frame() %>%
na.omit()
corMat  <- cor(pertenencia, use="na.or.complete", method="spearman")  # estimar matriz correlacion
cfa_1a <- '
identificacion =~ c32_01_w01 + c32_02_w01
justicia =~ c18_09_w01 + c18_10_w01
instituciones =~ c05_01_w01 + c05_02_w01 + c05_03_w01 + c05_04_w01 + c05_05_w01 + c05_06_w01 + c05_07_w01 + c05_08_w01
'
fit_1a <- cfa(cfa_1a,data=pertenencia,missing="ML",estimator="MLR")
pertenencia = data %>%
dplyr::select(c32_01_w01, c32_02_w01, c18_09_w01, c18_10_w01, c05_01_w01, c05_02_w01, c05_05_w01, c05_07_w01, c05_08_w01) %>%
as.data.frame() %>%
na.omit()
corMat  <- cor(pertenencia, use="na.or.complete", method="spearman")  # estimar matriz correlacion
pertenencia = data %>%
dplyr::select(c32_01_w01, c32_02_w01, c18_09_w01, c18_10_w01, c05_01_w01, c05_02_w01, c05_03_w01, c05_04_w01, c05_05_w01, c05_06_w01, c05_07_w01, c05_08_w01) %>%
as.data.frame() %>%
na.omit()
corMat  <- cor(pertenencia, use="na.or.complete", method="spearman")  # estimar matriz correlacion
cfa_1a <- '
identificacion =~ c32_01_w01 + c32_02_w01
justicia =~ c18_09_w01 + c18_10_w01
instituciones =~ c05_01_w01 + c05_02_w01 + c05_03_w01 + c05_04_w01 + c05_05_w01 + c05_06_w01 + c05_07_w01 + c05_08_w01
'
fit_1a <- cfa(cfa_1a,data=pertenencia,missing="ML",estimator="MLR")
fitMeasures(fit_1a, c("chisq", "df", "pvalue", "cfi", "tli", "rmsea"))
semPaths(fit_1a, intercepts = FALSE,edge.label.cex=1.5, optimizeLatRes = TRUE, groups = "lat",pastel = TRUE, exoVar = FALSE, sizeInt=5,edge.color ="black",esize = 6, label.prop=2,sizeLat = 6,"std", layout="circle2")
conf_institucional = data %>%
dplyr::select(c05_01_w01, c05_02_w01, c05_03_w01, c05_04_w01, c05_05_w01, c05_06_w01, c05_07_w01, c05_08_w01) %>%
as.data.frame() %>%
na.omit()
cfa_1a <- '
confianza =~ c05_01_w01 + c05_02_w01 + c05_03_w01 + c05_04_w01 + c05_05_w01 + c05_06_w01 + c05_07_w01 + c05_08_w01
'
fit_1a <- cfa(cfa_1a,data=conf_institucional,missing="ML",estimator="MLR")
fitMeasures(fit_1a, c("chisq", "df", "pvalue", "cfi", "tli", "rmsea"))
semPaths(fit_1a, intercepts = FALSE,edge.label.cex=1.5, optimizeLatRes = TRUE, groups = "lat",pastel = TRUE, exoVar = FALSE, sizeInt=5,edge.color ="black",esize = 6, label.prop=2,sizeLat = 6,"std", layout="circle2")
# Quedan fuera de instituciones c05_03, c05_04 y c05_06 por baja estimacion
cfa_1b <- '
identificacion =~ c32_01_w01 + c32_02_w01
justicia =~ c18_09_w01 + c18_10_w01
instituciones =~ c05_01_w01 + c05_02_w01 + c05_05_w01 + c05_07_w01 + c05_08_w01
'
fit_1b <- cfa(cfa_1b,data=pertenencia,missing="ML",estimator="MLR")
fitMeasures(fit_1b, c("chisq", "df", "pvalue", "cfi", "tli", "rmsea"))
semPaths(fit_1b, intercepts = FALSE,edge.label.cex=1.5, optimizeLatRes = TRUE, groups = "lat",pastel = TRUE, exoVar = FALSE, sizeInt=5,edge.color ="black",esize = 6, label.prop=2,sizeLat = 6,"std", layout="circle2")
identificacion =~ c32_01_w01 + c32_02_w01
# Quedan fuera de instituciones c05_05 por baja estimacion
cfa_1c <- '
identificacion =~ c32_01_w01 + c32_02_w01
justicia =~ c18_09_w01 + c18_10_w01
instituciones =~ c05_01_w01 + c05_02_w01 + c05_07_w01 + c05_08_w01
'
fit_1c <- cfa(cfa_1c,data=pertenencia,missing="ML",estimator="MLR")
fitMeasures(fit_1c, c("chisq", "df", "pvalue", "cfi", "tli", "rmsea"))
semPaths(fit_1c, intercepts = FALSE,edge.label.cex=1.5, optimizeLatRes = TRUE, groups = "lat",pastel = TRUE, exoVar = FALSE, sizeInt=5,edge.color ="black",esize = 6, label.prop=2,sizeLat = 6,"std", layout="circle2")
fitMeasures(fit_1a, c("chisq", "df", "pvalue", "cfi", "tli", "rmsea"))
fitMeasures(fit_1b, c("chisq", "df", "pvalue", "cfi", "tli", "rmsea"))
fitMeasures(fit_1c, c("chisq", "df", "pvalue", "cfi", "tli", "rmsea"))
organizaciones = data %>%
dplyr::select(c12_01_w01, c12_02_w01,c12_03_w01,c12_04_w01,c12_05_w01,c12_06_w01,c12_07_w01,c12_08_w01) %>%
as.data.frame() %>%
na.omit()
## Pasar "no tenia edad" a "no"
organizaciones$c12_01_w01 <- car::recode(organizaciones$c12_01_w01, "3=1")
organizaciones$c12_02_w01 <- car::recode(organizaciones$c12_02_w01, "3=1")
organizaciones$c12_03_w01 <- car::recode(organizaciones$c12_03_w01, "3=1")
organizaciones$c12_04_w01 <- car::recode(organizaciones$c12_04_w01, "3=1")
organizaciones$c12_05_w01 <- car::recode(organizaciones$c12_05_w01, "3=1")
organizaciones$c12_06_w01 <- car::recode(organizaciones$c12_06_w01, "3=1")
organizaciones$c12_07_w01 <- car::recode(organizaciones$c12_07_w01, "3=1")
organizaciones$c12_08_w01 <- car::recode(organizaciones$c12_08_w01, "3=1")
corMat  <- cor(organizaciones, use="na.or.complete", method="spearman")  # estimar matriz correlacion
cfa_1a <- '
organizaciones =~ c12_01_w01 + c12_02_w01 + c12_03_w01 + c12_04_w01 + c12_05_w01 + c12_06_w01 + c12_07_w01 + c12_08_w01
'
fit_1a <- cfa(cfa_1a,data=organizaciones,missing="ML",estimator="MLR")
fitMeasures(fit_1a, c("chisq", "df", "pvalue", "cfi", "tli", "rmsea"))
semPaths(fit_1a, intercepts = FALSE,edge.label.cex=1.5, optimizeLatRes = TRUE, groups = "lat",pastel = TRUE, exoVar = FALSE, sizeInt=5,edge.color ="black",esize = 6, label.prop=2,sizeLat = 6,"std", layout="circle2")
# Quedan fuera c12_01 y c12_02 por bajas correlaciones
cfa_1b <- '
organizaciones =~ c12_03_w01 + c12_04_w01 + c12_05_w01 + c12_06_w01 + c12_07_w01 + c12_08_w01
'
fit_1b <- cfa(cfa_1b,data=organizaciones,missing="ML",estimator="MLR")
fitMeasures(fit_1b, c("chisq", "df", "pvalue", "cfi", "tli", "rmsea"))
semPaths(fit_1b, intercepts = FALSE,edge.label.cex=1.5, optimizeLatRes = TRUE, groups = "lat",pastel = TRUE, exoVar = FALSE, sizeInt=5,edge.color ="black",esize = 6, label.prop=2,sizeLat = 6,"std", layout="circle2")
bien_comun = data %>%
dplyr::select(c07_03_w01, c07_05_w01, c07_06_w01, c07_07_w01, c07_08_w01, c08_01_w01, c08_02_w01, c08_03_w01, c08_04_w01, c12_03_w01, c12_04_w01, c12_05_w01, c12_06_w01, c12_07_w01, c12_08_w01, c11_w01) %>%
as.data.frame() %>%
na.omit()
## Pasar "no tenia edad" a "no"
bien_comun$c12_03_w01 <- car::recode(bien_comun$c12_03_w01, "3=1")
bien_comun$c12_04_w01 <- car::recode(bien_comun$c12_04_w01, "3=1")
bien_comun$c12_05_w01 <- car::recode(bien_comun$c12_05_w01, "3=1")
bien_comun$c12_06_w01 <- car::recode(bien_comun$c12_06_w01, "3=1")
bien_comun$c12_07_w01 <- car::recode(bien_comun$c12_07_w01, "3=1")
bien_comun$c12_08_w01 <- car::recode(bien_comun$c12_08_w01, "3=1")
bien_comun$c11_w01 <- car::recode(bien_comun$c11_w01, "3=1")
cfa_1a <- '
solidaridad =~ c07_03_w01 + c07_05_w01 + c07_06_w01 + c07_07_w01 + c07_08_w01
participacion =~ c08_01_w01 + c08_02_w01 + c08_03_w01 + c08_04_w01
organizaciones =~ c12_03_w01 + c12_04_w01 + c12_05_w01 + c12_06_w01 + c12_07_w01 + c12_08_w01
voto =~ c11_w01
'
fit_1a <- cfa(cfa_1a,data=bien_comun,missing="ML",estimator="MLR")
semPaths(fit_1a, intercepts = FALSE,edge.label.cex=1.5, optimizeLatRes = TRUE, groups = "lat",pastel = TRUE, exoVar = FALSE, sizeInt=5,edge.color ="black",esize = 6, label.prop=2,sizeLat = 6,"std", layout="circle2")
cfa_1b <- '
solidaridad =~ c07_05_w01 + c07_06_w01 + c07_07_w01 + c07_08_w01
participacion =~ c08_01_w01 + c08_02_w01 + c08_03_w01 + c08_04_w01
organizaciones =~ c12_03_w01 + c12_04_w01 + c12_05_w01 + c12_06_w01 + c12_07_w01 + c12_08_w01
voto =~ c11_w01
'
fit_1b <- cfa(cfa_1b,data=bien_comun,missing="ML",estimator="MLR")
fitMeasures(fit_1b, c("chisq", "df", "pvalue", "cfi", "tli", "rmsea"))
semPaths(fit_1b, intercepts = FALSE,edge.label.cex=1.5, optimizeLatRes = TRUE, groups = "lat",pastel = TRUE, exoVar = FALSE, sizeInt=5,edge.color ="black",esize = 6, label.prop=2,sizeLat = 6,"std", layout="circle2")
cfa_1b <- '
solidaridad =~ c07_03_w01 + c07_05_w01 + c07_06_w01 + c07_07_w01 + c07_08_w01
participacion =~ c08_01_w01 + c08_02_w01 + c08_03_w01 + c08_04_w01
voto =~ c11_w01
'
fit_1b <- cfa(cfa_1b,data=bien_comun,missing="ML",estimator="MLR")
fitMeasures(fit_1b, c("chisq", "df", "pvalue", "cfi", "tli", "rmsea"))
semPaths(fit_1b, intercepts = FALSE,edge.label.cex=1.5, optimizeLatRes = TRUE, groups = "lat",pastel = TRUE, exoVar = FALSE, sizeInt=5,edge.color ="black",esize = 6, label.prop=2,sizeLat = 6,"std", layout="circle2")
participacion = data %>%
dplyr::select(c08_01_w01, c08_02_w01, c08_03_w01, c08_04_w01) %>%
as.data.frame() %>%
na.omit()
cfa_1a <- '
participacion =~ c08_01_w01 + c08_02_w01 + c08_03_w01 + c08_04_w01
'
fit_1a <- cfa(cfa_1a,data=participacion,missing="ML",estimator="MLR")
fitMeasures(fit_1a, c("chisq", "df", "pvalue", "cfi", "tli", "rmsea"))
semPaths(fit_1a, intercepts = FALSE,edge.label.cex=1.5, optimizeLatRes = TRUE, groups = "lat",pastel = TRUE, exoVar = FALSE, sizeInt=5,edge.color ="black",esize = 6, label.prop=2,sizeLat = 6,"std", layout="circle2")
cfa_1a <- '
participacion =~ c08_02_w01 + c08_03_w01 + c08_04_w01
'
fit_1a <- cfa(cfa_1a,data=participacion,missing="ML",estimator="MLR")
fitMeasures(fit_1a, c("chisq", "df", "pvalue", "cfi", "tli", "rmsea"))
semPaths(fit_1a, intercepts = FALSE,edge.label.cex=1.5, optimizeLatRes = TRUE, groups = "lat",pastel = TRUE, exoVar = FALSE, sizeInt=5,edge.color ="black",esize = 6, label.prop=2,sizeLat = 6,"std", layout="circle2")
participacion =~ c08_01_w01 + c08_02_w01 + c08_03_w01 + c08_04_w01
cfa_1a <- '
participacion =~ c08_01_w01 + c08_02_w01 + c08_03_w01 + c08_04_w01
'
fit_1a <- cfa(cfa_1a,data=participacion,missing="ML",estimator="MLR")
cfa_1a <- '
participacion =~ c08_01_w01 + c08_02_w01 + c08_03_w01 + c08_04_w01
'
fit_1a <- cfa(cfa_1a,data=participacion,missing="ML",estimator="MLR")
cfa_1a <- '
participacion =~ c08_01_w01 + c08_02_w01 + c08_03_w01 + c08_04_w01
'
fit_1a <- cfa(cfa_1a,data=participacion,missing="ML",estimator="MLR")
cfa_1b <- '
solidaridad =~ c07_03_w01 + c07_05_w01 + c07_06_w01 + c07_07_w01 + c07_08_w01
participacion =~ c08_01_w01 + c08_02_w01 + c08_03_w01 + c08_04_w01
organizaciones =~ c12_03_w01 + c12_04_w01 + c12_05_w01 + c12_06_w01 + c12_07_w01 + c12_08_w01
'
fit_1b <- cfa(cfa_1b,data=bien_comun,missing="ML",estimator="MLR")
fitMeasures(fit_1b, c("chisq", "df", "pvalue", "cfi", "tli", "rmsea"))
semPaths(fit_1b, intercepts = FALSE,edge.label.cex=1.5, optimizeLatRes = TRUE, groups = "lat",pastel = TRUE, exoVar = FALSE, sizeInt=5,edge.color ="black",esize = 6, label.prop=2,sizeLat = 6,"std", layout="circle2")
cfa_1a <- '
solidaridad =~ c07_03_w01 + c07_05_w01 + c07_06_w01 + c07_07_w01 + c07_08_w01
participacion =~ c08_01_w01 + c08_02_w01 + c08_03_w01 + c08_04_w01
organizaciones =~ c12_03_w01 + c12_04_w01 + c12_05_w01 + c12_06_w01 + c12_07_w01 + c12_08_w01
voto =~ c11_w01
'
fit_1a <- cfa(cfa_1a,data=bien_comun,missing="ML",estimator="MLR")
fitMeasures(fit_1a, c("chisq", "df", "pvalue", "cfi", "tli", "rmsea"))
cfa_1b <- '
solidaridad =~ c07_03_w01 + c07_05_w01 + c07_06_w01 + c07_07_w01 + c07_08_w01
participacion =~ c08_01_w01 + c08_02_w01 + c08_03_w01 + c08_04_w01
organizaciones =~ c12_03_w01 + c12_04_w01 + c12_05_w01 + c12_06_w01 + c12_07_w01 + c12_08_w01
'
fit_1b <- cfa(cfa_1b,data=bien_comun,missing="ML",estimator="MLR")
fitMeasures(fit_1b, c("chisq", "df", "pvalue", "cfi", "tli", "rmsea"))
cfa_1b <- '
solidaridad =~ c07_03_w01 + c07_05_w01 + c07_06_w01 + c07_07_w01 + c07_08_w01
participacion =~ c08_01_w01 + c08_02_w01 + c08_03_w01 + c08_04_w01
voto =~ c11_w01
'
fit_1b <- cfa(cfa_1b,data=bien_comun,missing="ML",estimator="MLR")
fitMeasures(fit_1b, c("chisq", "df", "pvalue", "cfi", "tli", "rmsea"))
fitMeasures(fit_1a, c("chisq", "df", "pvalue", "cfi", "tli", "rmsea"))
semPaths(fit_1a, intercepts = FALSE,edge.label.cex=1.5, optimizeLatRes = TRUE, groups = "lat",pastel = TRUE, exoVar = FALSE, sizeInt=5,edge.color ="black",esize = 6, label.prop=2,sizeLat = 6,"std", layout="circle2")
# Quedan fuera estimaciones menores a 0.5 (c12_08, c12_07, c12_06, c12_03, c07_03)
cfa_1b <- '
solidaridad =~ c07_05_w01 + c07_06_w01 + c07_07_w01 + c07_08_w01
participacion =~ c08_01_w01 + c08_02_w01 + c08_03_w01 + c08_04_w01
organizaciones =~ c12_04_w01 + c12_05_w01
voto =~ c11_w01
'
fit_1b <- cfa(cfa_1b,data=bien_comun,missing="ML",estimator="MLR")
fitMeasures(fit_1b, c("chisq", "df", "pvalue", "cfi", "tli", "rmsea"))
fitMeasures(fit_1a, c("chisq", "df", "pvalue", "cfi", "tli", "rmsea"))
semPaths(fit_1a, intercepts = FALSE,edge.label.cex=1.5, optimizeLatRes = TRUE, groups = "lat",pastel = TRUE, exoVar = FALSE, sizeInt=5,edge.color ="black",esize = 6, label.prop=2,sizeLat = 6,"std", layout="circle2")
# LibrerÃ­as
pacman::p_load(lavaan, # pacman para instalar / cargar
psych, # para funcion lowerMat
Hmisc, # rcorr
stargazer,
xtable,
semPlot,
semTools,
remedy,
haven,
h2o,
polycor,
car,
sjlabelled,
sjmisc,
misty,
SciViews,
summarytools,
dplyr)
# Base
# Cargar base elsoc longitudinal (2016-2019)
load("../input/data/data.RData")
# Filtramos base para dejar casos completos de 2016 al 2019 sin inconsistencias
data <- data %>% dplyr::filter(tipo_atricion==1 & tipo_caso !=2)
# crear una base de datos con menos variables para estimar los AFC
bien_comun = data %>%
dplyr::select(c07_03_w01, c07_05_w01, c07_06_w01, c07_07_w01, c07_08_w01, c08_01_w01, c08_02_w01, c08_03_w01, c08_04_w01, c12_03_w01, c12_04_w01, c12_05_w01, c12_06_w01, c12_07_w01, c12_08_w01, c11_w01) %>%
as.data.frame() %>%
na.omit()
View(bien_comun)
## Pasar "no tenia edad" a "no"
bien_comun$c12_03_w01 <- car::recode(bien_comun$c12_03_w01, "3=1")
bien_comun$c12_04_w01 <- car::recode(bien_comun$c12_04_w01, "3=1")
bien_comun$c12_05_w01 <- car::recode(bien_comun$c12_05_w01, "3=1")
bien_comun$c12_06_w01 <- car::recode(bien_comun$c12_06_w01, "3=1")
bien_comun$c12_07_w01 <- car::recode(bien_comun$c12_07_w01, "3=1")
bien_comun$c12_08_w01 <- car::recode(bien_comun$c12_08_w01, "3=1")
bien_comun$c11_w01 <- car::recode(bien_comun$c11_w01, "3=1")
cfa_1c <- '
solidaridad =~ c07_05_w01 + c07_06_w01 + c07_07_w01 + c07_08_w01
participacion =~ c08_01_w01 + c08_02_w01 + c08_03_w01 + c08_04_w01
voto =~ c11_w01
'
fit_1c <- cfa(cfa_1c,data=bien_comun,missing="ML",estimator="MLR")
fitMeasures(fit_1c, c("chisq", "df", "pvalue", "cfi", "tli", "rmsea"))
cfa_1b <- '
solidaridad =~ c07_05_w01 + c07_06_w01 + c07_07_w01 + c07_08_w01
participacion =~ c08_01_w01 + c08_02_w01 + c08_03_w01 + c08_04_w01
organizaciones =~ c12_04_w01 + c12_05_w01
voto =~ c11_w01
'
fit_1b <- cfa(cfa_1b,data=bien_comun,missing="ML",estimator="MLR")
fitMeasures(fit_1b, c("chisq", "df", "pvalue", "cfi", "tli", "rmsea"))
cfa_1a <- '
solidaridad =~ c07_03_w01 + c07_05_w01 + c07_06_w01 + c07_07_w01 + c07_08_w01
participacion =~ c08_01_w01 + c08_02_w01 + c08_03_w01 + c08_04_w01
organizaciones =~ c12_03_w01 + c12_04_w01 + c12_05_w01 + c12_06_w01 + c12_07_w01 + c12_08_w01
voto =~ c11_w01
'
fit_1a <- cfa(cfa_1a,data=bien_comun,missing="ML",estimator="MLR")
fitMeasures(fit_1a, c("chisq", "df", "pvalue", "cfi", "tli", "rmsea"))
mod=modificationindices(fit_1a)
subset(mod, mi>3.84, select=lhs:mi)
cfa_1c <- '
solidaridad =~ c07_05_w01 + c07_06_w01 + c07_07_w01 + c07_08_w01
participacion =~ c08_01_w01 + c08_02_w01 + c08_04_w01
organizaciones =~ c12_04_w01 + c12_05_w01
voto =~ c11_w01
'
fit_1c <- cfa(cfa_1c,data=bien_comun,missing="ML",estimator="MLR")
fitMeasures(fit_1c, c("chisq", "df", "pvalue", "cfi", "tli", "rmsea"))
cfa_1c <- '
solidaridad =~ c07_03_w01 + c07_05_w01 + c07_06_w01 + c07_07_w01 + c07_08_w01
participacion =~ c08_01_w01 + c08_02_w01 + c08_04_w01
organizaciones =~ c12_03_w01 + c12_04_w01 + c12_05_w01 + c12_06_w01 + c12_07_w01 + c12_08_w01
voto =~ c11_w01
'
fit_1c <- cfa(cfa_1c,data=bien_comun,missing="ML",estimator="MLR")
fitMeasures(fit_1c, c("chisq", "df", "pvalue", "cfi", "tli", "rmsea"))
mod=modificationindices(fit_1c)
subset(mod, mi>3.84, select=lhs:mi)
semPaths(fit_1c, intercepts = FALSE,edge.label.cex=1.5, optimizeLatRes = TRUE, groups = "lat",pastel = TRUE, exoVar = FALSE, sizeInt=5,edge.color ="black",esize = 6, label.prop=2,sizeLat = 6,"std", layout="circle2")
# crear una base de datos con menos variables para estimar los AFC
relaciones_sociales = data %>%
dplyr::select(r15_w02, c02_w01, c03_w01, c04_w01, r12_03_w01, r12_04_w01, c06_04_w01, c06_05_w01, c06_06_w01) %>%
as.data.frame() %>%
na.omit()
cfa_1a <- '
lazos =~ r15_w02
confianza =~ c02_w01 + c03_w01 + c04_w01
diversidad =~ r12_03_w01 + r12_04_w01 + c06_04_w01 + c06_05_w01 + c06_06_w01
'
fit_1a <- cfa(cfa_1a,data=relaciones_sociales,missing="ML",estimator="MLR")
fitMeasures(fit_1a, c("chisq", "df", "pvalue", "cfi", "tli", "rmsea"))
mod=modificationindices(fit_1a)
subset(mod, mi>3.84, select=lhs:mi)
cfa_1b <- '
lazos =~ r15_w02
confianza =~ c02_w01 + c03_w01 + c04_w01
prejuicios =~ r12_03_w01 + r12_04_w01
diversidad =~ c06_04_w01 + c06_05_w01 + c06_06_w01
'
fit_1b <- cfa(cfa_1b,data=relaciones_sociales,missing="ML",estimator="MLR")
fitMeasures(fit_1b, c("chisq", "df", "pvalue", "cfi", "tli", "rmsea"))
mod=modificationindices(fit_1b)
subset(mod, mi>3.84, select=lhs:mi)
cfa_1b <- '
lazos =~ r15_w02
confianza =~ c02_w01 + c03_w01 + c04_w01
prejuicios =~ r12_03_w01 + r12_04_w01
diversidad =~ c06_04_w01 + c06_05_w01
'
fit_1b <- cfa(cfa_1b,data=relaciones_sociales,missing="ML",estimator="MLR")
fitMeasures(fit_1b, c("chisq", "df", "pvalue", "cfi", "tli", "rmsea"))
cfa_1b <- '
lazos =~ r15_w02
confianza =~ c02_w01 + c03_w01 + c04_w01
prejuicios =~ r12_03_w01 + r12_04_w01 + c06_06_w01
diversidad =~ c06_04_w01 + c06_05_w01
'
fit_1b <- cfa(cfa_1b,data=relaciones_sociales,missing="ML",estimator="MLR")
fitMeasures(fit_1b, c("chisq", "df", "pvalue", "cfi", "tli", "rmsea"))
cfa_1b <- '
lazos =~ r15_w02
confianza =~ c02_w01 + c03_w01 + c04_w01
prejuicios =~ r12_03_w01 + r12_04_w01 + c06_06_w01
diversidad =~ c06_04_w01 + c06_05_w01
'
fit_1b <- cfa(cfa_1b,data=relaciones_sociales,missing="ML",estimator="MLR")
fitMeasures(fit_1b, c("chisq", "df", "pvalue", "cfi", "tli", "rmsea"))
cfa_1c <- '
lazos =~ r15_w02
confianza =~ c02_w01 + c03_w01 + c04_w01
prejuicios =~ r12_03_w01 + r12_04_w01
diversidad =~ c06_04_w01 + c06_05_w01
'
fit_1c <- cfa(cfa_1c,data=relaciones_sociales,missing="ML",estimator="MLR")
fitMeasures(fit_1c, c("chisq", "df", "pvalue", "cfi", "tli", "rmsea"))
semPaths(fit_1b, intercepts = FALSE,edge.label.cex=1.5, optimizeLatRes = TRUE, groups = "lat",pastel = TRUE, exoVar = FALSE, sizeInt=5,edge.color ="black",esize = 6, label.prop=2,sizeLat = 6,"std", layout="circle2")
semPaths(fit_1c, intercepts = FALSE,edge.label.cex=1.5, optimizeLatRes = TRUE, groups = "lat",pastel = TRUE, exoVar = FALSE, sizeInt=5,edge.color ="black",esize = 6, label.prop=2,sizeLat = 6,"std", layout="circle2")
mod=modificationindices(fit_1c)
subset(mod, mi>3.84, select=lhs:mi)
cfa_2a <- '
identificacion =~ c32_01_w01 + c32_02_w01
justicia =~ c18_09_w01 + c18_10_w01
instituciones =~ c05_01_w01 + c05_02_w01 + c05_03_w01 + c05_04_w01 + c05_05_w01 + c05_06_w01 + c05_07_w01 + c05_08_w01
'
fit_2a <- cfa(cfa_2a,data=pertenencia,missing="ML",estimator="MLR")
# crear una base de datos con menos variables para estimar los AFC
pertenencia = data %>%
dplyr::select(c32_01_w01, c32_02_w01, c18_09_w01, c18_10_w01, c05_01_w01, c05_02_w01, c05_03_w01, c05_04_w01, c05_05_w01, c05_06_w01, c05_07_w01, c05_08_w01) %>%
as.data.frame() %>%
na.omit()
cfa_2a <- '
identificacion =~ c32_01_w01 + c32_02_w01
justicia =~ c18_09_w01 + c18_10_w01
instituciones =~ c05_01_w01 + c05_02_w01 + c05_03_w01 + c05_04_w01 + c05_05_w01 + c05_06_w01 + c05_07_w01 + c05_08_w01
'
fit_2a <- cfa(cfa_2a,data=pertenencia,missing="ML",estimator="MLR")
fitMeasures(fit_2a, c("chisq", "df", "pvalue", "cfi", "tli", "rmsea"))
mod=modificationindices(fit_2a)
subset(mod, mi>3.84, select=lhs:mi)
# Quedan fuera de instituciones c05_03, c05_04 y c05_06 por baja estimacion
cfa_2b <- '
identificacion =~ c32_01_w01 + c32_02_w01
justicia =~ c18_09_w01 + c18_10_w01
instituciones =~ c05_01_w01 + c05_02_w01 + c05_03_w01 + c05_04_w01 + c05_05_w01 + c05_06_w01 + c05_07_w01
'
fit_2b <- cfa(cfa_2b,data=pertenencia,missing="ML",estimator="MLR")
fitMeasures(fit_2b, c("chisq", "df", "pvalue", "cfi", "tli", "rmsea"))
mod=modificationindices(fit_2b)
subset(mod, mi>3.84, select=lhs:mi)
# Quedan fuera de instituciones c05_02 por "mi" alto
cfa_2c <- '
identificacion =~ c32_01_w01 + c32_02_w01
justicia =~ c18_09_w01 + c18_10_w01
instituciones =~ c05_01_w01 + c05_03_w01 + c05_04_w01 + c05_05_w01 + c05_06_w01 + c05_07_w01
'
fit_2c <- cfa(cfa_2c,data=pertenencia,missing="ML",estimator="MLR")
fitMeasures(fit_2c, c("chisq", "df", "pvalue", "cfi", "tli", "rmsea"))
# crear una base de datos con menos variables para estimar los AFC
bien_comun = data %>%
dplyr::select(c07_03_w01, c07_05_w01, c07_06_w01, c07_07_w01, c07_08_w01, c08_01_w01, c08_02_w01, c08_03_w01, c08_04_w01, c12_03_w01, c12_04_w01, c12_05_w01, c12_06_w01, c12_07_w01, c12_08_w01, c11_w01) %>%
as.data.frame() %>%
na.omit()
## Pasar "no tenia edad" a "no"
bien_comun$c12_03_w01 <- car::recode(bien_comun$c12_03_w01, "3=1")
bien_comun$c12_04_w01 <- car::recode(bien_comun$c12_04_w01, "3=1")
bien_comun$c12_05_w01 <- car::recode(bien_comun$c12_05_w01, "3=1")
bien_comun$c12_06_w01 <- car::recode(bien_comun$c12_06_w01, "3=1")
bien_comun$c12_07_w01 <- car::recode(bien_comun$c12_07_w01, "3=1")
bien_comun$c12_08_w01 <- car::recode(bien_comun$c12_08_w01, "3=1")
bien_comun$c11_w01 <- car::recode(bien_comun$c11_w01, "3=1")
cfa_3a <- '
solidaridad =~ c07_03_w01 + c07_05_w01 + c07_06_w01 + c07_07_w01 + c07_08_w01
participacion =~ c08_01_w01 + c08_02_w01 + c08_03_w01 + c08_04_w01
organizaciones =~ c12_03_w01 + c12_04_w01 + c12_05_w01 + c12_06_w01 + c12_07_w01 + c12_08_w01
voto =~ c11_w01
'
fit_3a <- cfa(cfa_3a,data=bien_comun,missing="ML",estimator="MLR")
fitMeasures(fit_3a, c("chisq", "df", "pvalue", "cfi", "tli", "rmsea"))
mod=modificationindices(fit_3a)
subset(mod, mi>3.84, select=lhs:mi)
# Queda fuera c08_03 por "mi" alto
cfa_3b <- '
solidaridad =~ c07_03_w01 + c07_05_w01 + c07_06_w01 + c07_07_w01 + c07_08_w01
participacion =~ c08_01_w01 + c08_02_w01 + c08_04_w01
organizaciones =~ c12_03_w01 + c12_04_w01 + c12_05_w01 + c12_06_w01 + c12_07_w01 + c12_08_w01
voto =~ c11_w01
'
fit_3b <- cfa(cfa_3b,data=bien_comun,missing="ML",estimator="MLR")
fitMeasures(fit_3b, c("chisq", "df", "pvalue", "cfi", "tli", "rmsea"))
mod=modificationindices(fit_3b)
subset(mod, mi>3.84, select=lhs:mi)
